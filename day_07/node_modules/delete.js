const { readFile, writeFile } = require("./readAndWrite.js");

const File = "./user.json";

const deleteUser = async (email) => {
    try {
        const users = await readFile(File);
        let message = " ";
        
        if (users.length === 0) {
            message = "No users found.";
        } else {
            const userIndex = users.findIndex((u) => u.email === email);
            
            if (userIndex === -1) {
                message = "User not found.";
            } else {
                users.splice(userIndex, 1);
                await writeFile(File, users);
                message = "User deleted successfully";
            }
        }
        
        console.log(message);
        return message;
    } catch (error) {
        const message = "Error during user deletion: " + error.message;
        console.log(message);
        return message;
    }
};

module.exports = { deleteUser };
